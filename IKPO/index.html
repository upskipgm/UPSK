<!DOCTYPE html>
<html lang="ms">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Soal Selidik Analisis Keperluan Pembinaan Instrumen Ketahanan Psikologi Organisasi</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
        }
        .form-radio {
            -webkit-appearance: none;
            -moz-appearance: none;
            appearance: none;
            display: inline-block;
            position: relative;
            background-color: #f9fafb;
            border: 1px solid #d1d5db;
            border-radius: 50%;
            width: 1.5rem;
            height: 1.5rem;
            cursor: pointer;
            transition: background-color 0.2s, border-color 0.2s;
        }
        .form-radio:checked {
            background-color: #3b82f6;
            border-color: #3b82f6;
        }
        .form-radio:checked::after {
            content: '';
            display: block;
            position: absolute;
            top: 50%;
            left: 50%;
            width: 0.75rem;
            height: 0.75rem;
            border-radius: 50%;
            background-color: white;
            transform: translate(-50%, -50%);
        }
        .form-radio:focus {
            outline: 2px solid transparent;
            outline-offset: 2px;
            box-shadow: 0 0 0 2px #60a5fa;
        }
        .error-question {
            background-color: #fee2e2;
        }
        .error-title {
            color: #ef4444;
        }
        .loader {
            border: 4px solid #f3f3f3;
            border-top: 4px solid #3498db;
            border-radius: 50%;
            width: 24px;
            height: 24px;
            animation: spin 1s linear infinite;
            display: inline-block;
            margin-right: 10px;
        }
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
    </style>
</head>
<body class="bg-gray-100 text-gray-800">

    <div class="container mx-auto max-w-4xl p-4 sm:p-8">
        <!-- Header -->
        <div class="bg-white p-6 rounded-xl shadow-md mb-8">
            <h1 class="text-center text-2xl sm:text-3xl font-bold text-gray-900 mb-6">Soal Selidik Analisis Keperluan Pembinaan Instrumen Ketahanan Psikologi Organisasi</h1>
            
            <div class="text-left">
                <h2 class="text-xl font-bold text-gray-800 mb-2">Latar Belakang</h2>
                <p class="mb-4 text-gray-600">
                    Kesejahteraan psikologi merupakan aspek penting yang mempengaruhi prestasi kerja, motivasi, dan kepuasan individu di tempat kerja, termasuk dalam kalangan pegawai, pensyarah, dan staf sokongan di Institut Pendidikan Guru (IPG). Buat masa ini, masih belum wujud instrumen standard yang dibangunkan khusus untuk mengukur kesejahteraan psikologi warga IPG yang merangkumi keperluan asas psikologi dan tahap resiliens. Oleh itu, kajian analisis keperluan ini dijalankan bagi mendapatkan maklumat awal sebelum pembinaan instrumen kesejahteraan psikologi yang sah dan sesuai untuk digunakan oleh kaunselor pendidikan di IPG.
                </p>

                <h2 class="text-xl font-bold text-gray-800 mb-2">Tujuan</h2>
                <p class="mb-4 text-gray-600">
                    Analisis keperluan (need analysis) ini dijalankan adalah bertujuan untuk:
                </p>
                <ul class="list-disc list-inside text-gray-600 space-y-1">
                    <li>Menilai persepsi umum warga IPG tentang kepentingan kesejahteraan psikologi.</li>
                    <li>Mengenal pasti keperluan membangunkan instrumen kesejahteraan psikologi.</li>
                    <li>Mengenal pasti komponen yang wajar dimasukkan dalam instrumen kesejahteraan psikologi.</li>
                    <li>Menilai tahap kesediaan warga IPG dalam memberikan maklum balas berkaitan instrumen.</li>
                    <li>Menyediakan asas bagi pembinaan instrumen yang sah dan praktikal.</li>
                </ul>
            </div>
        </div>
        
        <div id="errorMessage" class="hidden bg-red-100 border-l-4 border-red-500 text-red-700 p-4 rounded-lg mb-6" role="alert">
            <p class="font-bold">Sila Lengkapkan Borang</p>
            <p>Terdapat soalan yang belum dijawab. Sila lengkapkan semua soalan yang ditandakan.</p>
        </div>
        
        <div id="submissionError" class="hidden bg-red-100 border-l-4 border-red-500 text-red-700 p-4 rounded-lg mb-6" role="alert">
            <p class="font-bold">Penghantaran Gagal</p>
            <p>Maaf, terdapat ralat semasa menghantar jawapan anda. Sila cuba lagi.</p>
        </div>

        <form id="questionnaireForm">
            <!-- Section A: Demographic Information -->
            <div id="sectionA" class="bg-white p-6 rounded-xl shadow-md mb-8">
                <h2 class="section-title text-xl font-bold text-gray-900 border-b pb-3 mb-6 transition-colors duration-300">BAHAGIAN A: MAKLUMAT DEMOGRAFI</h2>
                
                <div data-question="a1" class="mb-6 p-4 rounded-lg transition-colors duration-300">
                    <label class="block text-gray-800 font-semibold mb-3 text-lg">1. Jawatan</label>
                    <div class="space-y-2">
                        <div><label class="flex items-center"><input type="radio" name="a1" value="Pegawai" class="form-radio mr-3"><span class="text-gray-700">Pegawai</span></label></div>
                        <div><label class="flex items-center"><input type="radio" name="a1" value="Pensyarah" class="form-radio mr-3"><span class="text-gray-700">Pensyarah</span></label></div>
                        <div><label class="flex items-center"><input type="radio" name="a1" value="Staf Sokongan" class="form-radio mr-3"><span class="text-gray-700">Staf Sokongan</span></label></div>
                    </div>
                </div>

                <div data-question="a2" class="mb-6 p-4 rounded-lg transition-colors duration-300">
                    <label class="block text-gray-800 font-semibold mb-3 text-lg">2. Tempoh Perkhidmatan</label>
                    <div class="space-y-2">
                        <div><label class="flex items-center"><input type="radio" name="a2" value="Kurang dari 5 tahun" class="form-radio mr-3"><span class="text-gray-700">Kurang dari 5 tahun</span></label></div>
                        <div><label class="flex items-center"><input type="radio" name="a2" value="5 - 10 tahun" class="form-radio mr-3"><span class="text-gray-700">5 - 10 tahun</span></label></div>
                        <div><label class="flex items-center"><input type="radio" name="a2" value="Lebih dari 10 tahun" class="form-radio mr-3"><span class="text-gray-700">Lebih dari 10 tahun</span></label></div>
                    </div>
                </div>

                <div data-question="a3" class="mb-4 p-4 rounded-lg transition-colors duration-300">
                     <label class="block text-gray-800 font-semibold mb-3 text-lg">3. Jantina</label>
                    <div class="space-y-2">
                        <div><label class="flex items-center"><input type="radio" name="a3" value="Lelaki" class="form-radio mr-3"><span class="text-gray-700">Lelaki</span></label></div>
                        <div><label class="flex items-center"><input type="radio" name="a3" value="Perempuan" class="form-radio mr-3"><span class="text-gray-700">Perempuan</span></label></div>
                    </div>
                </div>
            </div>

            <!-- Section B: Perception -->
            <div id="sectionB" class="bg-white p-6 rounded-xl shadow-md mb-8">
                <h2 class="section-title text-xl font-bold text-gray-900 border-b pb-3 mb-4 transition-colors duration-300">BAHAGIAN B: PERSEPSI TERHADAP KEPERLUAN PEMBINAAN INSTRUMEN</h2>
                <p class="text-gray-600 mt-2 mb-4">Sila nyatakan tahap persetujuan anda bagi setiap pernyataan di bawah. <br>
                    <span class="font-medium">Skala: 1 = Sangat Tidak Setuju, 2 = Tidak Setuju, 3 = Neutral, 4 = Setuju, 5 = Sangat Setuju</span>
                </p>
                <div class="overflow-x-auto">
                    <table class="w-full min-w-[600px]">
                        <thead>
                            <tr class="bg-gray-50">
                                <th class="p-3 text-left font-semibold text-gray-700 w-12">Bil.</th>
                                <th class="p-3 text-left font-semibold text-gray-700">Pernyataan</th>
                                <th class="w-12 text-center font-semibold text-gray-700">1</th>
                                <th class="w-12 text-center font-semibold text-gray-700">2</th>
                                <th class="w-12 text-center font-semibold text-gray-700">3</th>
                                <th class="w-12 text-center font-semibold text-gray-700">4</th>
                                <th class="w-12 text-center font-semibold text-gray-700">5</th>
                            </tr>
                        </thead>
                        <tbody>
                            <!-- Dimensi 1 -->
                            <tr class="bg-gray-100">
                                <td colspan="7" class="p-3 font-bold text-gray-800">Dimensi 1: Menilai persepsi umum warga IPG tentang kepentingan kesejahteraan psikologi</td>
                            </tr>
                            <tr data-question="b1" class="border-b transition-colors duration-300 hover:bg-gray-50">
                                <td class="p-3 font-medium">1.</td>
                                <td class="p-3">Kesejahteraan psikologi adalah penting dalam meningkatkan prestasi kerja warga IPG.</td>
                                <td class="p-3 text-center"><input type="radio" name="b1" value="1" class="form-radio"></td>
                                <td class="p-3 text-center"><input type="radio" name="b1" value="2" class="form-radio"></td>
                                <td class="p-3 text-center"><input type="radio" name="b1" value="3" class="form-radio"></td>
                                <td class="p-3 text-center"><input type="radio" name="b1" value="4" class="form-radio"></td>
                                <td class="p-3 text-center"><input type="radio" name="b1" value="5" class="form-radio"></td>
                            </tr>
                            <tr data-question="b2" class="border-b transition-colors duration-300 hover:bg-gray-50">
                                <td class="p-3 font-medium">2.</td>
                                <td class="p-3">Kesejahteraan psikologi membantu mengurangkan tekanan kerja dalam kalangan staf IPG.</td>
                                <td class="p-3 text-center"><input type="radio" name="b2" value="1" class="form-radio"></td>
                                <td class="p-3 text-center"><input type="radio" name="b2" value="2" class="form-radio"></td>
                                <td class="p-3 text-center"><input type="radio" name="b2" value="3" class="form-radio"></td>
                                <td class="p-3 text-center"><input type="radio" name="b2" value="4" class="form-radio"></td>
                                <td class="p-3 text-center"><input type="radio" name="b2" value="5" class="form-radio"></td>
                            </tr>
                            <tr data-question="b3" class="border-b transition-colors duration-300 hover:bg-gray-50">
                                <td class="p-3 font-medium">3.</td>
                                <td class="p-3">Kesejahteraan psikologi perlu diberi perhatian sama seperti kesejahteraan fizikal.</td>
                                <td class="p-3 text-center"><input type="radio" name="b3" value="1" class="form-radio"></td>
                                <td class="p-3 text-center"><input type="radio" name="b3" value="2" class="form-radio"></td>
                                <td class="p-3 text-center"><input type="radio" name="b3" value="3" class="form-radio"></td>
                                <td class="p-3 text-center"><input type="radio" name="b3" value="4" class="form-radio"></td>
                                <td class="p-3 text-center"><input type="radio" name="b3" value="5" class="form-radio"></td>
                            </tr>
                            <tr data-question="b4" class="border-b transition-colors duration-300 hover:bg-gray-50">
                                <td class="p-3 font-medium">4.</td>
                                <td class="p-3">Kesejahteraan psikologi mempunyai hubungan rapat dengan motivasi kerja.</td>
                                <td class="p-3 text-center"><input type="radio" name="b4" value="1" class="form-radio"></td>
                                <td class="p-3 text-center"><input type="radio" name="b4" value="2" class="form-radio"></td>
                                <td class="p-3 text-center"><input type="radio" name="b4" value="3" class="form-radio"></td>
                                <td class="p-3 text-center"><input type="radio" name="b4" value="4" class="form-radio"></td>
                                <td class="p-3 text-center"><input type="radio" name="b4" value="5" class="form-radio"></td>
                            </tr>
                            <tr data-question="b5" class="border-b transition-colors duration-300 hover:bg-gray-50">
                                <td class="p-3 font-medium">5.</td>
                                <td class="p-3">Pihak pengurusan IPG wajar memberi penekanan terhadap aspek kesejahteraan psikologi.</td>
                                <td class="p-3 text-center"><input type="radio" name="b5" value="1" class="form-radio"></td>
                                <td class="p-3 text-center"><input type="radio" name="b5" value="2" class="form-radio"></td>
                                <td class="p-3 text-center"><input type="radio" name="b5" value="3" class="form-radio"></td>
                                <td class="p-3 text-center"><input type="radio" name="b5" value="4" class="form-radio"></td>
                                <td class="p-3 text-center"><input type="radio" name="b5" value="5" class="form-radio"></td>
                            </tr>
                             <!-- Dimensi 2 -->
                            <tr class="bg-gray-100">
                                <td colspan="7" class="p-3 font-bold text-gray-800">Dimensi 2: Mengenal pasti keperluan membangunkan instrumen kesejahteraan psikologi</td>
                            </tr>
                            <tr data-question="b6" class="border-b transition-colors duration-300 hover:bg-gray-50">
                                <td class="p-3 font-medium">6.</td>
                                <td class="p-3">Warga IPG memerlukan instrumen khusus untuk menilai tahap kesejahteraan psikologi.</td>
                                <td class="p-3 text-center"><input type="radio" name="b6" value="1" class="form-radio"></td>
                                <td class="p-3 text-center"><input type="radio" name="b6" value="2" class="form-radio"></td>
                                <td class="p-3 text-center"><input type="radio" name="b6" value="3" class="form-radio"></td>
                                <td class="p-3 text-center"><input type="radio" name="b6" value="4" class="form-radio"></td>
                                <td class="p-3 text-center"><input type="radio" name="b6" value="5" class="form-radio"></td>
                            </tr>
                            <tr data-question="b7" class="border-b transition-colors duration-300 hover:bg-gray-50">
                                <td class="p-3 font-medium">7.</td>
                                <td class="p-3">Instrumen kesejahteraan psikologi dapat membantu mengenal pasti isu-isu psikologi di tempat kerja.</td>
                                <td class="p-3 text-center"><input type="radio" name="b7" value="1" class="form-radio"></td>
                                <td class="p-3 text-center"><input type="radio" name="b7" value="2" class="form-radio"></td>
                                <td class="p-3 text-center"><input type="radio" name="b7" value="3" class="form-radio"></td>
                                <td class="p-3 text-center"><input type="radio" name="b7" value="4" class="form-radio"></td>
                                <td class="p-3 text-center"><input type="radio" name="b7" value="5" class="form-radio"></td>
                            </tr>
                            <tr data-question="b8" class="border-b transition-colors duration-300 hover:bg-gray-50">
                                <td class="p-3 font-medium">8.</td>
                                <td class="p-3">Instrumen ini penting untuk menyokong program intervensi kesejahteraan warga IPG.</td>
                                <td class="p-3 text-center"><input type="radio" name="b8" value="1" class="form-radio"></td>
                                <td class="p-3 text-center"><input type="radio" name="b8" value="2" class="form-radio"></td>
                                <td class="p-3 text-center"><input type="radio" name="b8" value="3" class="form-radio"></td>
                                <td class="p-3 text-center"><input type="radio" name="b8" value="4" class="form-radio"></td>
                                <td class="p-3 text-center"><input type="radio" name="b8" value="5" class="form-radio"></td>
                            </tr>
                            <tr data-question="b9" class="border-b transition-colors duration-300 hover:bg-gray-50">
                                <td class="p-3 font-medium">9.</td>
                                <td class="p-3">Pembangunan instrumen dapat menyediakan data saintifik untuk kegunaan pihak pengurusan IPG.</td>
                                <td class="p-3 text-center"><input type="radio" name="b9" value="1" class="form-radio"></td>
                                <td class="p-3 text-center"><input type="radio" name="b9" value="2" class="form-radio"></td>
                                <td class="p-3 text-center"><input type="radio" name="b9" value="3" class="form-radio"></td>
                                <td class="p-3 text-center"><input type="radio" name="b9" value="4" class="form-radio"></td>
                                <td class="p-3 text-center"><input type="radio" name="b9" value="5" class="form-radio"></td>
                            </tr>
                            <tr data-question="b10" class="border-b transition-colors duration-300 hover:bg-gray-50">
                                <td class="p-3 font-medium">10.</td>
                                <td class="p-3">Instrumen kesejahteraan psikologi akan menjadi panduan dalam merancang program pembangunan staf.</td>
                                <td class="p-3 text-center"><input type="radio" name="b10" value="1" class="form-radio"></td>
                                <td class="p-3 text-center"><input type="radio" name="b10" value="2" class="form-radio"></td>
                                <td class="p-3 text-center"><input type="radio" name="b10" value="3" class="form-radio"></td>
                                <td class="p-3 text-center"><input type="radio" name="b10" value="4" class="form-radio"></td>
                                <td class="p-3 text-center"><input type="radio" name="b10" value="5" class="form-radio"></td>
                            </tr>
                            <!-- Dimensi 3 -->
                            <tr class="bg-gray-100">
                                <td colspan="7" class="p-3 font-bold text-gray-800">Dimensi 3: Mengenal pasti komponen yang wajar dimasukkan dalam instrumen kesejahteraan psikologi</td>
                            </tr>
                            <tr data-question="b11" class="border-b transition-colors duration-300 hover:bg-gray-50">
                                <td class="p-3 font-medium">11.</td>
                                <td class="p-3">Instrumen wajar merangkumi aspek keseimbangan kerja dan kehidupan.</td>
                                <td class="p-3 text-center"><input type="radio" name="b11" value="1" class="form-radio"></td>
                                <td class="p-3 text-center"><input type="radio" name="b11" value="2" class="form-radio"></td>
                                <td class="p-3 text-center"><input type="radio" name="b11" value="3" class="form-radio"></td>
                                <td class="p-3 text-center"><input type="radio" name="b11" value="4" class="form-radio"></td>
                                <td class="p-3 text-center"><input type="radio" name="b11" value="5" class="form-radio"></td>
                            </tr>
                            <tr data-question="b12" class="border-b transition-colors duration-300 hover:bg-gray-50">
                                <td class="p-3 font-medium">12.</td>
                                <td class="p-3">Instrumen perlu mengukur tahap sokongan sosial di tempat kerja.</td>
                                <td class="p-3 text-center"><input type="radio" name="b12" value="1" class="form-radio"></td>
                                <td class="p-3 text-center"><input type="radio" name="b12" value="2" class="form-radio"></td>
                                <td class="p-3 text-center"><input type="radio" name="b12" value="3" class="form-radio"></td>
                                <td class="p-3 text-center"><input type="radio" name="b12" value="4" class="form-radio"></td>
                                <td class="p-3 text-center"><input type="radio" name="b12" value="5" class="form-radio"></td>
                            </tr>
                            <tr data-question="b13" class="border-b transition-colors duration-300 hover:bg-gray-50">
                                <td class="p-3 font-medium">13.</td>
                                <td class="p-3">Instrumen harus menilai tahap pengurusan emosi dan daya tindak (coping skills).</td>
                                <td class="p-3 text-center"><input type="radio" name="b13" value="1" class="form-radio"></td>
                                <td class="p-3 text-center"><input type="radio" name="b13" value="2" class="form-radio"></td>
                                <td class="p-3 text-center"><input type="radio" name="b13" value="3" class="form-radio"></td>
                                <td class="p-3 text-center"><input type="radio" name="b13" value="4" class="form-radio"></td>
                                <td class="p-3 text-center"><input type="radio" name="b13" value="5" class="form-radio"></td>
                            </tr>
                            <tr data-question="b14" class="border-b transition-colors duration-300 hover:bg-gray-50">
                                <td class="p-3 font-medium">14.</td>
                                <td class="p-3">Instrumen perlu mengukur tahap motivasi dan kepuasan kerja.</td>
                                <td class="p-3 text-center"><input type="radio" name="b14" value="1" class="form-radio"></td>
                                <td class="p-3 text-center"><input type="radio" name="b14" value="2" class="form-radio"></td>
                                <td class="p-3 text-center"><input type="radio" name="b14" value="3" class="form-radio"></td>
                                <td class="p-3 text-center"><input type="radio" name="b14" value="4" class="form-radio"></td>
                                <td class="p-3 text-center"><input type="radio" name="b14" value="5" class="form-radio"></td>
                            </tr>
                            <tr data-question="b15" class="border-b transition-colors duration-300 hover:bg-gray-50">
                                <td class="p-3 font-medium">15.</td>
                                <td class="p-3">Instrumen wajar memasukkan elemen daya tahan (resilience) terhadap tekanan.</td>
                                <td class="p-3 text-center"><input type="radio" name="b15" value="1" class="form-radio"></td>
                                <td class="p-3 text-center"><input type="radio" name="b15" value="2" class="form-radio"></td>
                                <td class="p-3 text-center"><input type="radio" name="b15" value="3" class="form-radio"></td>
                                <td class="p-3 text-center"><input type="radio" name="b15" value="4" class="form-radio"></td>
                                <td class="p-3 text-center"><input type="radio" name="b15" value="5" class="form-radio"></td>
                            </tr>
                            <!-- Dimensi 4 -->
                             <tr class="bg-gray-100">
                                <td colspan="7" class="p-3 font-bold text-gray-800">Dimensi 4: Menilai tahap kesediaan warga IPG dalam memberikan maklum balas berkaitan instrumen</td>
                            </tr>
                            <tr data-question="b16" class="border-b transition-colors duration-300 hover:bg-gray-50">
                                <td class="p-3 font-medium">16.</td>
                                <td class="p-3">Saya bersedia untuk memberikan maklum balas terhadap instrumen kesejahteraan psikologi.</td>
                                <td class="p-3 text-center"><input type="radio" name="b16" value="1" class="form-radio"></td>
                                <td class="p-3 text-center"><input type="radio" name="b16" value="2" class="form-radio"></td>
                                <td class="p-3 text-center"><input type="radio" name="b16" value="3" class="form-radio"></td>
                                <td class="p-3 text-center"><input type="radio" name="b16" value="4" class="form-radio"></td>
                                <td class="p-3 text-center"><input type="radio" name="b16" value="5" class="form-radio"></td>
                            </tr>
                            <tr data-question="b17" class="border-b transition-colors duration-300 hover:bg-gray-50">
                                <td class="p-3 font-medium">17.</td>
                                <td class="p-3">Saya tidak keberatan berkongsi pandangan mengenai kesejahteraan psikologi saya.</td>
                                <td class="p-3 text-center"><input type="radio" name="b17" value="1" class="form-radio"></td>
                                <td class="p-3 text-center"><input type="radio" name="b17" value="2" class="form-radio"></td>
                                <td class="p-3 text-center"><input type="radio" name="b17" value="3" class="form-radio"></td>
                                <td class="p-3 text-center"><input type="radio" name="b17" value="4" class="form-radio"></td>
                                <td class="p-3 text-center"><input type="radio" name="b17" value="5" class="form-radio"></td>
                            </tr>
                            <tr data-question="b18" class="border-b transition-colors duration-300 hover:bg-gray-50">
                                <td class="p-3 font-medium">18.</td>
                                <td class="p-3">Saya yakin maklumat yang diberikan akan digunakan secara beretika dan sulit.</td>
                                <td class="p-3 text-center"><input type="radio" name="b18" value="1" class="form-radio"></td>
                                <td class="p-3 text-center"><input type="radio" name="b18" value="2" class="form-radio"></td>
                                <td class="p-3 text-center"><input type="radio" name="b18" value="3" class="form-radio"></td>
                                <td class="p-3 text-center"><input type="radio" name="b18" value="4" class="form-radio"></td>
                                <td class="p-3 text-center"><input type="radio" name="b18" value="5" class="form-radio"></td>
                            </tr>
                            <tr data-question="b19" class="border-b transition-colors duration-300 hover:bg-gray-50">
                                <td class="p-3 font-medium">19.</td>
                                <td class="p-3">Saya berasa selesa menjawab soal selidik berkaitan kesejahteraan psikologi.</td>
                                <td class="p-3 text-center"><input type="radio" name="b19" value="1" class="form-radio"></td>
                                <td class="p-3 text-center"><input type="radio" name="b19" value="2" class="form-radio"></td>
                                <td class="p-3 text-center"><input type="radio" name="b19" value="3" class="form-radio"></td>
                                <td class="p-3 text-center"><input type="radio" name="b19" value="4" class="form-radio"></td>
                                <td class="p-3 text-center"><input type="radio" name="b19" value="5" class="form-radio"></td>
                            </tr>
                            <tr data-question="b20" class="border-b transition-colors duration-300 hover:bg-gray-50">
                                <td class="p-3 font-medium">20.</td>
                                <td class="p-3">Saya percaya maklum balas saya akan memberi manfaat kepada pembangunan organisasi.</td>
                                <td class="p-3 text-center"><input type="radio" name="b20" value="1" class="form-radio"></td>
                                <td class="p-3 text-center"><input type="radio" name="b20" value="2" class="form-radio"></td>
                                <td class="p-3 text-center"><input type="radio" name="b20" value="3" class="form-radio"></td>
                                <td class="p-3 text-center"><input type="radio" name="b20" value="4" class="form-radio"></td>
                                <td class="p-3 text-center"><input type="radio" name="b20" value="5" class="form-radio"></td>
                            </tr>
                            <!-- Dimensi 5 -->
                             <tr class="bg-gray-100">
                                <td colspan="7" class="p-3 font-bold text-gray-800">Dimensi 5: Menyediakan asas bagi pembinaan instrumen yang sah dan praktikal</td>
                            </tr>
                            <tr data-question="b21" class="border-b transition-colors duration-300 hover:bg-gray-50">
                                <td class="p-3 font-medium">21.</td>
                                <td class="p-3">Instrumen kesejahteraan psikologi perlu dibina berasaskan teori dan kajian empirikal.</td>
                                <td class="p-3 text-center"><input type="radio" name="b21" value="1" class="form-radio"></td>
                                <td class="p-3 text-center"><input type="radio" name="b21" value="2" class="form-radio"></td>
                                <td class="p-3 text-center"><input type="radio" name="b21" value="3" class="form-radio"></td>
                                <td class="p-3 text-center"><input type="radio" name="b21" value="4" class="form-radio"></td>
                                <td class="p-3 text-center"><input type="radio" name="b21" value="5" class="form-radio"></td>
                            </tr>
                            <tr data-question="b22" class="border-b transition-colors duration-300 hover:bg-gray-50">
                                <td class="p-3 font-medium">22.</td>
                                <td class="p-3">Instrumen yang sahih boleh membantu menghasilkan data yang boleh dipercayai.</td>
                                <td class="p-3 text-center"><input type="radio" name="b22" value="1" class="form-radio"></td>
                                <td class="p-3 text-center"><input type="radio" name="b22" value="2" class="form-radio"></td>
                                <td class="p-3 text-center"><input type="radio" name="b22" value="3" class="form-radio"></td>
                                <td class="p-3 text-center"><input type="radio" name="b22" value="4" class="form-radio"></td>
                                <td class="p-3 text-center"><input type="radio" name="b22" value="5" class="form-radio"></td>
                            </tr>
                            <tr data-question="b23" class="border-b transition-colors duration-300 hover:bg-gray-50">
                                <td class="p-3 font-medium">23.</td>
                                <td class="p-3">Instrumen yang praktikal memudahkan pentadbiran dan pengumpulan data.</td>
                                <td class="p-3 text-center"><input type="radio" name="b23" value="1" class="form-radio"></td>
                                <td class="p-3 text-center"><input type="radio" name="b23" value="2" class="form-radio"></td>
                                <td class="p-3 text-center"><input type="radio" name="b23" value="3" class="form-radio"></td>
                                <td class="p-3 text-center"><input type="radio" name="b23" value="4" class="form-radio"></td>
                                <td class="p-3 text-center"><input type="radio" name="b23" value="5" class="form-radio"></td>
                            </tr>
                            <tr data-question="b24" class="border-b transition-colors duration-300 hover:bg-gray-50">
                                <td class="p-3 font-medium">24.</td>
                                <td class="p-3">Instrumen yang sistematik dapat membantu mengenal pasti intervensi yang sesuai.</td>
                                <td class="p-3 text-center"><input type="radio" name="b24" value="1" class="form-radio"></td>
                                <td class="p-3 text-center"><input type="radio" name="b24" value="2" class="form-radio"></td>
                                <td class="p-3 text-center"><input type="radio" name="b24" value="3" class="form-radio"></td>
                                <td class="p-3 text-center"><input type="radio" name="b24" value="4" class="form-radio"></td>
                                <td class="p-3 text-center"><input type="radio" name="b24" value="5" class="form-radio"></td>
                            </tr>
                            <tr data-question="b25" class="transition-colors duration-300 hover:bg-gray-50">
                                <td class="p-3 font-medium">25.</td>
                                <td class="p-3">Instrumen yang baik akan menyumbang kepada pembinaan dasar kesejahteraan psikologi di IPG.</td>
                                <td class="p-3 text-center"><input type="radio" name="b25" value="1" class="form-radio"></td>
                                <td class="p-3 text-center"><input type="radio" name="b25" value="2" class="form-radio"></td>
                                <td class="p-3 text-center"><input type="radio" name="b25" value="3" class="form-radio"></td>
                                <td class="p-3 text-center"><input type="radio" name="b25" value="4" class="form-radio"></td>
                                <td class="p-3 text-center"><input type="radio" name="b25" value="5" class="form-radio"></td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>

            <!-- Submit Button -->
            <div class="text-center">
                <button id="submitButton" type="submit" class="bg-blue-600 text-white font-bold py-3 px-8 rounded-lg hover:bg-blue-700 focus:outline-none focus:ring-4 focus:ring-blue-300 transition-all duration-300 shadow-lg w-full sm:w-auto flex items-center justify-center mx-auto">
                    <span id="submitButtonText">Hantar</span>
                    <span id="submitButtonSpinner" class="hidden loader"></span>
                </button>
            </div>
        </form>
    </div>

    <!-- Modal for submission confirmation -->
    <div id="successModal" class="fixed inset-0 bg-gray-900 bg-opacity-50 flex items-center justify-center hidden z-50">
        <div class="bg-white p-8 rounded-xl shadow-2xl text-center max-w-sm mx-auto">
            <div class="mx-auto flex items-center justify-center h-12 w-12 rounded-full bg-green-100 mb-4">
                <svg class="h-6 w-6 text-green-600" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path></svg>
            </div>
            <h3 class="text-lg leading-6 font-medium text-gray-900">Terima Kasih!</h3>
            <div class="mt-2 px-7 py-3">
                <p class="text-sm text-gray-500">
                    Jawapan anda telah berjaya dihantar.
                </p>
            </div>
            <div class="mt-4">
                <button id="closeModal" type="button" class="px-4 py-2 bg-blue-600 text-white text-base font-medium rounded-md w-full shadow-sm hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500">
                    Tutup
                </button>
            </div>
        </div>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', function () {
            const SCRIPT_URL = 'https://script.google.com/macros/s/AKfycbzUpTczuF-ZRbXW7q1i8-B_v1TDW81SIWcxYkKtiYeumawAIgK324rNnUU1lm0kizky/exec'; // <-- PASTIKAN URL INI BETUL
            
            const form = document.getElementById('questionnaireForm');
            const submitButton = document.getElementById('submitButton');
            const submitButtonText = document.getElementById('submitButtonText');
            const submitButtonSpinner = document.getElementById('submitButtonSpinner');
            const modal = document.getElementById('successModal');
            const closeModalButton = document.getElementById('closeModal');
            const errorMessage = document.getElementById('errorMessage');
            const submissionError = document.getElementById('submissionError');

            form.addEventListener('submit', function(event) {
                event.preventDefault(); 
                
                if (validateForm()) {
                    submitButton.disabled = true;
                    submitButtonText.textContent = 'Menghantar...';
                    submitButtonSpinner.classList.remove('hidden');
                    submissionError.classList.add('hidden');

                    const formData = new FormData(form);
                    
                    fetch(SCRIPT_URL, { method: 'POST', body: formData})
                        .then(response => {
                            if (response.ok) {
                                modal.classList.remove('hidden');
                                errorMessage.classList.add('hidden');
                                form.reset();
                            } else {
                                throw new Error('Network response was not ok.');
                            }
                        })
                        .catch(error => {
                            console.error('Error!', error.message);
                            submissionError.classList.remove('hidden');
                        })
                        .finally(() => {
                            submitButton.disabled = false;
                            submitButtonText.textContent = 'Hantar';
                            submitButtonSpinner.classList.add('hidden');
                        });

                } else {
                    errorMessage.classList.remove('hidden');
                    const firstError = document.querySelector('.error-question, .error-title');
                    if (firstError) {
                        firstError.scrollIntoView({ behavior: 'smooth', block: 'center' });
                    }
                }
            });

            function validateForm() {
                let isFormValid = true;
                document.querySelectorAll('.error-question').forEach(el => el.classList.remove('error-question'));
                document.querySelectorAll('.error-title').forEach(el => el.classList.remove('error-title'));

                const questionGroups = form.querySelectorAll('[data-question]');
                questionGroups.forEach(group => {
                    const groupName = group.dataset.question;
                    const radios = form.querySelectorAll(`input[name="${groupName}"]`);
                    if (radios.length > 0) {
                        const isAnswered = Array.from(radios).some(radio => radio.checked);
                        if (!isAnswered) {
                            isFormValid = false;
                            group.classList.add('error-question');
                            const sectionTitle = group.closest('div[id^="section"]').querySelector('.section-title');
                            if(sectionTitle) sectionTitle.classList.add('error-title');
                        }
                    }
                });
                return isFormValid;
            }

            closeModalButton.addEventListener('click', function() {
                modal.classList.add('hidden');
                document.querySelectorAll('.error-question').forEach(el => el.classList.remove('error-question'));
                document.querySelectorAll('.error-title').forEach(el => el.classList.remove('error-title'));
            });
            
            modal.addEventListener('click', function(event) {
                if (event.target === modal) {
                    closeModalButton.click();
                }
            });
        });
    </script>

</body>
</html>

